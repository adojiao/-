name: Debug Fetch Worker

on:
  workflow_dispatch:

jobs:
  debug-worker:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Show current directory
      run: |
        echo "工作目录: $(pwd)"
        echo "文件列表:"
        ls -la
        
    - name: Download file
      run: |
        # 直接下载并显示结果
        curl -v -L -o _worker.js \
          "https://raw.githubusercontent.com/byJoey/cfnew/refs/heads/main/%E5%B0%91%E5%B9%B4%E4%BD%A0%E7%9B%B8%E4%BF%A1%E5%85%89%E5%90%97" 2> curl.log
        
        echo "CURL 日志:"
        cat curl.log
        
        echo "下载的文件信息:"
        ls -la _worker.js || echo "文件不存在"
        
        echo "文件内容:"
        cat _worker.js || echo "无法读取文件"
        
    - name: Save as artifact
      uses: actions/upload-artifact@v4
      with:
        name: worker-file
        path: _worker.js
